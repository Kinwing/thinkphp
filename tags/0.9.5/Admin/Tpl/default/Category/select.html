<tagLib name="html" />
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<TITLE>分类挑选</TITLE>
<html:link type="css" href ="../Public/css/FCS.css" />
<html:link type="css" href ="../Public/css/JTree.css" />
<html:import type="js" file="Js.Util.JTree" /> 
<SCRIPT LANGUAGE="JavaScript">
<!--
function ok(){
	var result = new Array();
	result[0]	= new Array();
	result[0][0]	=	document.getElementById('Name').value;
	result[0][1]	=	document.getElementById('Id').value;
	result[0][2]	=	document.getElementById('Level').value;

	returnValue=result;
	window.close(); 
}

//-->
</SCRIPT>
<base target="_self" />
</HEAD>

<BODY style="margin:0;overflow:hidden">
<FORM METHOD="POST" style="margin:0" name = "form1" ACTION="">
<div align="center">
<TABLE class="order" cellpadding=0 style="margin:0" cellspacing=0 width="100%">
<tr><td height="5" colspan="2" class="topTd" ></td></tr>
<TR>
	<Th colspan=2 align="center"><div class="fLeft"><input name="company" type="text" style="width:165px"></div>
<html:imageBtn value="查 询" click="form1.submit()" style="button " /></Th>
</TR>
<TR >
	<TD width="75%" >
	<INPUT TYPE="hidden" id="Id" ><INPUT TYPE="hidden" id="Name" ><INPUT TYPE="hidden" id="Level" >
	<div id="showTree" ></div>
<!-- 	<div class="solid">
	<SELECT class="multiSelect" ondblclick="ok()" name="agency" size="15">
<voList name="list" id="dealer" >
<option value="{$dealer.id}">{$dealer.company}</option>
</voList>
</SELECT></div> --></TD>
</TR>
<TR>
	<TD colspan=2 align="center">
	<div style="width:65%">
<html:imageBtn type="submit" value="确 定" click="ok()" style="button " /> 
<html:imageBtn type="reset" value="取 消" click="window.close()" style="button " />
</div>
</TD>
</TR>
<tr><td height="5" colspan="2" class="topTd" ></td></tr>
</TABLE>
</div>
</FORM>
<script language="javascript" type="text/javascript">
<!--
	function setValueById(pObjID,pValue){
		var obj=document.getElementById(pObjID);
		try{
			obj.value=pValue;
		}catch(e){
			alert("控件："+pObjID+"　不存在，或没有value属性")
		}
	}
	
	function $(pID){
		return document.getElementById(pID);
	}
	
	function getNodeAtt(pNode,pAtt){
		try{
			return pNode.attributes.getNamedItem(pAtt).nodeValue;
		}catch(e){
			alert("前台调试错误：\n"+e.message+"\n当前节点不存在: "+pAtt+"这个属性");
		}
	}
	parm	=	location.href.replace('http://'+location.hostname+'__ACT__','');
	var myTree=new JTree("showTree","__URL__/tree",false);
	myTree.setPicPath("__ROOT__/Public/JTreePic/")
	myTree.onclick=function(){
		if(getNodeAtt(myTree.selectNode,"id")==undefined){
			if (myTree.EXPANDALL == false)
			{
				myTree.expand(true);
			}else {
				myTree.expand(false);
			}
			
		}else {
		setValueById("Id",getNodeAtt(myTree.selectNode,"id"));
		setValueById("Name",getNodeAtt(myTree.selectNode,"caption"));
		setValueById("Level",getNodeAtt(myTree.selectNode,"level"));
		}
	}
	myTree.ondblclick=function(){
	if(getNodeAtt(myTree.selectNode,"id")!=undefined){
		setValueById("Id",getNodeAtt(myTree.selectNode,"id"));
		setValueById("Name",getNodeAtt(myTree.selectNode,"caption"));
		setValueById("Level",getNodeAtt(myTree.selectNode,"level"));
		ok();
		}
	}
	myTree.CAPTIONATT="caption";
	myTree.create();
	
function vControl(pChoice,pParm){
	switch(pChoice){
		case "REPLACE":
			var pattern=/\([0-9]+\)$/;
				return pParm.replace(pattern,"");
			break;
		case "FINDNODE":
			var obj;
			for(var i=0;obj=pParm[i];i++){
				alert(obj.caption);
				if(obj.caption==$("nodeCaption").value)
					obj.click();
			}
			break;
	}
}

function findNode(pTree){
	var obj;
	for(var i=0;obj=pTree[i];i++){
		str = $("nodeCaption").value;
		if(obj.caption.indexOf(str)!='-1'){
			obj.click();
			//obj.parentTreeNode.expand(true)
			myTree.clickItem.parentTreeNode.expand(true);
			return true;
		}
		findNode(obj.treeNodes)
	}
}

-->
</script>
</html>